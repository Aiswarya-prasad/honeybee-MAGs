# Purpose
Pipeline to find and identify population-specific ortholog clusters in microbial genomes.

# Inputs
* Genomes in `*.fasta` format.
* A tab-delimited cluster file generated by PopCOGenT (`*.cluster.tab.txt`).

# Output
* `*.flex_genes.csv`, a csv file that contains a list of all flexible ORFs found. Columns are as follows:

* `orf_id`: unique name for the open reading frame (ORF)
* `orf_contig`: name of the contig on which the ORF was identified
* `orf_seq`: nucleotide sequence of the ORF
* `orf_start`: ORF starting position
* `orf_end`: ORF end position
* `orf_strand`: indicates whether ORF is in the forward (1) or reverse (-1) orientation
* `orf_ortho_cluster`: ID of the ORF's ortholog cluster as identified by `mmseqs2`
* `strain`: strain in which the ORF was found
* `population`: population in which the ORF swept

# Setup
* Copy the `*.cluster.tab.txt` file to the `./input` directory.
* Set the parameters in `config.yaml`
* `genome_dir`, `num_threads`, `base_name`: please set these to the same values that you used for the PopCOGenT `cluster.sh` file.
* `Group_to_cluster`: Specify which "species-level" group you wish to cluster. These are the groups identified by the "Main_cluster" column of the `*.cluster.tab.txt` file. This is necessary because identifying sweeps is most informative to differentiate the most closely related populations.
* `alpha`: alpha (significance) level to determine if a putative sweep gene is recent. 0.05 is what we used for our own genomes.
* `prodigal_path`: provide absolute path to prodigal executable
* `mmseqs_path`: provide absolute path to mmseqs executable
* `muscle_path`: provide absolute path to muscle executable

# Execution
Run the pipeline by executing `bash snakemake.sh`.



